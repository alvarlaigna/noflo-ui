INPORT=Dispatch.IN:IN
OUTPORT=Dispatch.PASS:PASS
OUTPORT=NewActions.OUT:NEW

'flowhub:runtimes:fetch,flowhub:runtimes:register,flowhub:projects:fetch' -> ROUTES Dispatch(ui/DispatchAction)

# New actions generated by this middleware
'storage:save:runtime' -> ACTION RuntimeSaveAction(ui/SetAction)
RuntimeSaveAction OUT -> IN NewActions(core/Merge)
'flowhub:projects' -> ACTION RegistryProjectsAction(ui/SetAction)
RegistryProjectsAction OUT -> IN NewActions(core/Merge)
'flowhub:error' -> ACTION RegistryErrorAction(ui/SetAction)
RegistryErrorAction OUT -> IN NewActions

# Fetching list of user's registered runtimes
'user' -> KEYS GetUserStateFetch(ui/GetActionValues)
Dispatch HANDLE[0] -> IN GetUserStateFetch
GetUserStateFetch VALUES[0] -> USER GetRuntimes(ui/GetRemoteRuntimes)
GetRuntimes RUNTIME -> IN RuntimeSaveAction
GetRuntimes ERROR -> IN RegistryErrorAction

# Storing a new runtime definition to registry
'user' -> KEYS GetUserStatePut(ui/GetActionValues)
Dispatch HANDLE[1] -> IN GetUserStatePut
GetUserStatePut VALUES[0] -> USER SaveRuntime(ui/StoreRemoteRuntime)
GetUserStatePut OUT -> IN SaveRuntime
SaveRuntime OUT -> IN RuntimeSaveAction
SaveRuntime ERROR -> IN RegistryErrorAction

# Fetching projects list from registry
'user' -> KEYS GetUserStateProjects(ui/GetActionValues)
Dispatch HANDLE[2] -> IN GetUserStateProjects
GetUserStateProjects VALUES[0] -> USER GetRemoteProjects(ui/GetRemoteProjects)
GetRemoteProjects PROJECTS -> IN RegistryProjectsAction
GetRemoteProjects ERROR -> IN RegistryErrorAction
